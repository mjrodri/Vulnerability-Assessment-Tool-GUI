import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
import subprocess

def web_vulnerability_scan(url):
    try:
        # Use OWASP ZAP for web application scanning
        subprocess.run(["zap-cli", "quick-scan", "--self-contained", url])
        messagebox.showinfo("Scan Completed", "Web vulnerability scan completed successfully.")
    except Exception as e:
        messagebox.showerror("Error", f"An error occurred: {str(e)}")

def network_vulnerability_scan(ip):
    try:
        # Use Nmap for network scanning
        subprocess.run(["nmap", "-p", "-", ip])
        messagebox.showinfo("Scan Completed", "Network vulnerability scan completed successfully.")
    except Exception as e:
        messagebox.showerror("Error", f"An error occurred: {str(e)}")

def start_scan():
    web_url = entry_web_url.get()
    network_ip = entry_network_ip.get()

    if web_url:
        web_vulnerability_scan(web_url)
    elif network_ip:
        network_vulnerability_scan(network_ip)
    else:
        messagebox.showwarning("Input Error", "Please enter either a web URL or a network IP.")

# Create the main application window
app = tk.Tk()
app.title("Vulnerability Assessment Tool")

# Add elements
label_web_url = tk.Label(app, text="Web URL:")
label_web_url.grid(row=0, column=0, padx=10, pady=10)

entry_web_url = tk.Entry(app)
entry_web_url.grid(row=0, column=1, padx=10, pady=10)

label_network_ip = tk.Label(app, text="Network IP:")
label_network_ip.grid(row=1, column=0, padx=10, pady=10)

entry_network_ip = tk.Entry(app)
entry_network_ip.grid(row=1, column=1, padx=10, pady=10)

button_scan = tk.Button(app, text="Start Scan", command=start_scan)
button_scan.grid(row=2, column=0, columnspan=2, pady=10)

# Start the main loop
app.mainloop()